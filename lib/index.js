function _extends(){return _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},_extends.apply(this,arguments)}import React,{Component,createContext,useContext}from"react";import identity from"lodash/identity";import isFunction from"lodash/isFunction";import mapValues from"lodash/mapValues";export default(({defaultState:a=()=>{},actions:b=()=>{},storage:c="undefined"!=typeof window&&window.localStorage,storageKey:d="repersist-store",serialize:e=JSON.stringify,deserialize:f=JSON.parse,integrity:g=()=>!0,load:h=identity}={})=>{const i=isFunction(a)?a:()=>a,j=isFunction(b)?b:()=>b,k=createContext(),l=createContext();const m=({map:a=identity})=>React.createElement(k.Consumer,null,b=>React.createElement(l.Consumer,null,c=>this.props.children(a(b),c)));return{Provider:class extends Component{constructor(a){super(a);try{let a=c&&c.getItem(d);if(!a)throw new Error;if(a=f(a),!g(a))throw new Error;this.state=h(a)}catch(b){this.state=i(a)}c&&c.setItem(d,e(this.state)),this.actions=mapValues(j(this.setState.bind(this),a),a=>async(...b)=>{const c=await a(...b);"undefined"!=typeof c&&this.setState(c)})}render(){return React.createElement(k.Provider,{value:this.state},React.createElement(l.Provider,{value:this.actions},this.props.children))}},Consumer:m,withStore:(a=identity)=>b=>c=>React.createElement(m,{map:a},(a,d)=>React.createElement(b,_extends({},c,a,d))),useStore:(a=identity)=>{const b=useContext(k),c=useContext(l);return[a(b),c]}}});